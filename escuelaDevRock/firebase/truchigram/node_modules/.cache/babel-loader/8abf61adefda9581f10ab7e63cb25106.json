{"ast":null,"code":"var _jsxFileName = \"/mnt/c/users/Marcos/programacion/cursos/escuelaDevRock/firebase/truchigram/src/components/modal.js\";\nimport React from \"react\";\nimport M from \"materialize-css\";\nimport FileUpload from \"./fileUpload\";\nimport firebase from \"firebase/app\";\nimport \"firebase/database\";\nimport \"firebase/firebase-storage\";\n\nclass Modal extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      user: {\n        photoURL: \"\",\n        displayName: \"\"\n      },\n      uploadValue: 0\n    };\n\n    this.handleChange = e => {\n      this.setState({\n        txt: e.target.value\n      });\n    };\n\n    this.handleUpload = e => {\n      e.preventDefault();\n      const file = e.target.files[0];\n      const storageRef = firebase.storage().ref(`fotos/${file.name}`);\n      const task = storageRef.put(file);\n      task.on(\"state_changed\", snapshot => {\n        let percentage = snapshot.bytesTransferred / snapshot.totalBytes * 100;\n        this.setState({\n          uploadValue: percentage\n        });\n      }, //Lo que hacemos con los errores \n      error => {\n        console.log(error.message);\n      }, //Lo que hacemos ni bien subio la foto\n      () => {\n        const record = {\n          avatar: this.state.user.photoURL,\n          nombre: this.state.user.displayName,\n          txt: this.state.txt,\n          pic: task.snapshot.metadata.fullPath\n        };\n        const db = firebase.database();\n        const dbRef = db.ref(\"pictures\");\n        const newPicture = dbRef.push();\n        newPicture.set(record);\n      });\n    };\n  }\n\n  componentDidMount() {\n    M.AutoInit();\n    firebase.auth().onAuthStateChanged(user => {\n      this.setState({\n        user\n      });\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      href: \"#modal1\",\n      className: \"btn-floating btn-large waves-effect waves-light modal-trigger red FAB\",\n      id: \"fab\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"material-icons\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 11\n      }\n    }, \"add\")), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"modal1\",\n      className: \"modal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"modal-content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"h4\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 13\n      }\n    }, \"Poste\\xE1 en Truchigram\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"chip\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: this.state.user.photoURL,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 15\n      }\n    }), this.state.user.displayName), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      className: \"col l12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"input-field col s9 l4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"material-icons prefix\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 21\n      }\n    }, \"mode_edit\"), /*#__PURE__*/React.createElement(\"textarea\", {\n      id: \"icon_prefix2\",\n      className: \"materialize-textarea\",\n      onChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"icon_prefix2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 21\n      }\n    }, \"Mensaje\"), /*#__PURE__*/React.createElement(FileUpload, {\n      onUpload: this.handleUpload,\n      uploadValue: this.state.uploadValue,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 21\n      }\n    })))))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"modal-footer\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 11\n      }\n    })));\n  }\n\n}\n\nexport default Modal;","map":{"version":3,"sources":["/mnt/c/users/Marcos/programacion/cursos/escuelaDevRock/firebase/truchigram/src/components/modal.js"],"names":["React","M","FileUpload","firebase","Modal","Component","state","user","photoURL","displayName","uploadValue","handleChange","e","setState","txt","target","value","handleUpload","preventDefault","file","files","storageRef","storage","ref","name","task","put","on","snapshot","percentage","bytesTransferred","totalBytes","error","console","log","message","record","avatar","nombre","pic","metadata","fullPath","db","database","dbRef","newPicture","push","set","componentDidMount","AutoInit","auth","onAuthStateChanged","render"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport M from \"materialize-css\";\nimport FileUpload from \"./fileUpload\";\nimport firebase from \"firebase/app\";\nimport \"firebase/database\";\nimport \"firebase/firebase-storage\";\n\nclass Modal extends React.Component {\n\n  state = {\n    user: {\n      photoURL: \"\",\n      displayName: \"\",\n    },\n    uploadValue: 0,\n  };\n\n  componentDidMount() {\n    M.AutoInit();\n    firebase.auth().onAuthStateChanged(user =>{\n      this.setState({user})\n    })\n  }\n  handleChange = (e) =>{\n    this.setState({\n      txt: e.target.value\n    })\n  }\n\n  handleUpload = (e) =>{\n    e.preventDefault()\n    \n\n    const file = e.target.files[0];\n    const storageRef = firebase.storage().ref(`fotos/${file.name}`);\n    const task = storageRef.put(file);\n    \n    task.on(\"state_changed\", snapshot =>{\n      let percentage = (snapshot.bytesTransferred/snapshot.totalBytes) * 100;\n      this.setState({\n        uploadValue: percentage\n      })\n    },\n    //Lo que hacemos con los errores \n    error => {\n      console.log(error.message)\n    },\n    //Lo que hacemos ni bien subio la foto\n    () => {\n      const record = {\n        avatar: this.state.user.photoURL,\n        nombre: this.state.user.displayName,\n        txt: this.state.txt,\n        pic: task.snapshot.metadata.fullPath,\n      };\n      const db = firebase.database();\n    const dbRef = db.ref(\"pictures\");\n    const newPicture = dbRef.push();\n    newPicture.set(record);\n    }\n    );\n\n    \n\n  }\n\n  render() {\n    return (\n      <React.Fragment>\n        <a\n          href=\"#modal1\"\n          className=\"btn-floating btn-large waves-effect waves-light modal-trigger red FAB\"\n          id=\"fab\"\n        >\n          <i className=\"material-icons\">add</i>\n        </a>\n\n        <div id=\"modal1\" className=\"modal\">\n          <div className=\"modal-content\">\n            <h4>Posteá en Truchigram</h4>\n            <div className=\"chip\">\n              <img src={this.state.user.photoURL} />\n              {this.state.user.displayName}\n            </div>\n\n            <div className=\"row\">\n              <form className=\"col l12\">\n                <div className=\"row\">\n                  <div className=\"input-field col s9 l4\">\n                    <i className=\"material-icons prefix\">mode_edit</i>\n                    <textarea\n                      id=\"icon_prefix2\"\n                      className=\"materialize-textarea\"\n                      onChange={this.handleChange}\n                    />\n                    <label htmlFor=\"icon_prefix2\">Mensaje</label>\n                    <FileUpload onUpload={this.handleUpload} uploadValue={this.state.uploadValue} />\n                    \n                  </div>\n                </div>\n              </form>\n            </div>\n          </div>\n          <div className=\"modal-footer\" />\n        </div>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default Modal;\n"]},"metadata":{},"sourceType":"module"}